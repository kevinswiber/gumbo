# Task 2.2: Wire `insert_title_nodes()` into Pipeline

## Objective

Call `insert_title_nodes()` in the dagre layout pipeline between `nesting::cleanup()` and `nesting::assign_rank_minmax()`.

## Location

Modify: `src/dagre/mod.rs` — `layout_with_labels()` function, lines 114-118

## TDD Phases

### Red: Write Failing Test

No new test needed — the pipeline wiring is verified by the end-to-end compound layout test:

```rust
#[test]
fn test_layout_compound_titled_end_to_end() {
    let mut graph: DiGraph<(f64, f64)> = DiGraph::new();
    graph.add_node("sg1", (0.0, 0.0));
    graph.add_node("A", (40.0, 20.0));
    graph.add_node("B", (40.0, 20.0));
    graph.add_edge("A", "B");
    graph.set_parent("A", "sg1");
    graph.set_parent("B", "sg1");
    graph.set_has_title("sg1");

    let config = LayoutConfig::default();
    let result = layout(&graph, &config, |_, dims| *dims);

    // Layout should complete without panic
    assert!(result.nodes.contains_key(&"A".into()));
    assert!(result.nodes.contains_key(&"B".into()));
    assert!(result.subgraph_bounds.contains_key("sg1"));
}
```

**Expected failure reason:** Without the pipeline wiring, `set_has_title()` populates `compound_titles` but `insert_title_nodes()` is never called, so `border_title` is empty. The layout runs but without title rank separation. This test passes even without the wiring (no panic), so the real verification is in tasks 2.1 (unit tests) and 5.1 (integration tests).

### Green: Minimal Implementation

Change lines 114-118 in `mod.rs`:

```rust
// Current:
if has_compound {
    nesting::cleanup(&mut lg);
    nesting::assign_rank_minmax(&mut lg);
}

// New:
if has_compound {
    nesting::cleanup(&mut lg);
    nesting::insert_title_nodes(&mut lg);
    nesting::assign_rank_minmax(&mut lg);
}
```

### Refactor: Clean Up

None — this is a single line addition.

## Context

The pipeline position is critical: `insert_title_nodes()` must run after `rank::normalize()` (so ranks are 0-based) and after `nesting::cleanup()` (so nesting edges are excluded), but before `assign_rank_minmax()` (which reads `border_title` to set `min_rank`).

## Acceptance Criteria

- [ ] `insert_title_nodes()` called in correct pipeline position
- [ ] End-to-end compound layout test passes
- [ ] All existing tests still pass
