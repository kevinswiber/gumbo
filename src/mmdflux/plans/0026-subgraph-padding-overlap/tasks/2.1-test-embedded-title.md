# Task 2.1: Test Embedded Title Rendering

## Objective
Write failing tests that define the expected embedded-title behavior: titles appear within the top border line as `â”Œâ”€ Title â”€â”`, not floating above the box.

## Location
Modify: `/Users/kevin/src/mmdflux-subgraphs/src/render/subgraph.rs` (add tests)

## TDD Phases

### ğŸ”´ Red: Write Failing Tests

```rust
#[test]
fn test_render_subgraph_embedded_title() {
    let charset = CharSet::unicode();
    let mut canvas = Canvas::new(20, 7);
    let bounds = SubgraphBounds {
        x: 2, y: 2, width: 14, height: 5,
        title: "Group".to_string(),
    };

    render_subgraph_borders(&mut canvas, &[bounds], &charset);

    let output = canvas.to_string();
    let lines: Vec<&str> = output.lines().collect();

    // Title should be embedded in the top border at row 2
    assert!(lines[2].contains("â”€ Group â”€"),
        "Expected embedded title in top border, got: {}", lines[2]);

    // Row above border (row 1) should NOT contain title text
    assert!(!lines[1].contains("Group"),
        "Title should not appear above border, got: {}", lines[1]);
}

#[test]
fn test_render_subgraph_title_at_y0() {
    let charset = CharSet::unicode();
    let mut canvas = Canvas::new(20, 7);
    let bounds = SubgraphBounds {
        x: 0, y: 0, width: 16, height: 5,
        title: "TopGroup".to_string(),
    };

    render_subgraph_borders(&mut canvas, &[bounds], &charset);

    let output = canvas.to_string();
    let lines: Vec<&str> = output.lines().collect();

    // Title should be visible even at y=0 (embedded in border)
    assert!(lines[0].contains("TopGroup"),
        "Title should render at y=0, got: {}", lines[0]);
}

#[test]
fn test_render_subgraph_narrow_border_truncates_title() {
    let charset = CharSet::unicode();
    let mut canvas = Canvas::new(15, 5);
    let bounds = SubgraphBounds {
        x: 0, y: 0, width: 8, height: 5,
        title: "Very Long Title".to_string(),
    };

    render_subgraph_borders(&mut canvas, &[bounds], &charset);

    let output = canvas.to_string();
    // Title should be truncated to fit within border
    // Width 8: corners (2) + "â”€ " prefix (2) + " â”€" suffix (2) = 6 overhead, 2 chars for title
    // Or however the truncation works â€” the key point is no overflow
    assert!(!output.contains("Very Long Title"),
        "Full title should not appear in narrow border");
    // Border corners should still be intact
    assert!(output.contains("â”Œ"), "Top-left corner should exist");
    assert!(output.contains("â”"), "Top-right corner should exist");
}
```

**What the failing tests assert:** Titles are embedded in the top border line, visible at y=0, and truncated when too wide.
**Expected failure reason:** Current code places title at `y-1` as floating text and skips rendering when `y == 0`.

### ğŸŸ¢ Green: Minimal Implementation

*(Implementation is in Task 2.2.)*

### ğŸ”µ Refactor: Clean Up

After Task 2.2 makes these pass, review test values for edge cases.

## Context
- Current title rendering is in `render_subgraph_borders()` at `src/render/subgraph.rs` lines 26-30
- Title is placed at `(x + i, y - 1)` with `if y > 0` guard
- See [Q2: Title rendering](../../../research/0019-subgraph-padding-overlap/q2-title-rendering.md)

## Acceptance Criteria
- [ ] Three failing tests written: embedded title, y=0 visibility, narrow truncation
- [ ] All tests confirmed red
