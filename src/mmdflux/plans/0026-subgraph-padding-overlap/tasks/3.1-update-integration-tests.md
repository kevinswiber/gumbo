# Task 3.1: Update Integration Tests for New Rendering Format

## Objective
Update all subgraph-related integration tests to expect the new embedded-title format and verify non-overlap behavior.

## Location
Modify: `/Users/kevin/src/mmdflux-subgraphs/tests/integration.rs`

## TDD Phases

### ðŸ”´ Red: Write Failing Tests

Add new integration tests:

```rust
#[test]
fn test_multi_subgraph_no_border_overlap() {
    let input = std::fs::read_to_string("tests/fixtures/subgraph_edges.mmd").unwrap();
    let output = render_to_string(&input);
    // Parse output to find border box regions and assert no overlap
    // (Or at minimum, assert no garbled character sequences)
}

#[test]
fn test_lr_subgraph_title_visible() {
    let input = std::fs::read_to_string("tests/fixtures/multi_subgraph.mmd").unwrap();
    let output = render_to_string(&input);
    assert!(output.contains("Frontend"), "Frontend title should be visible");
    assert!(output.contains("Backend"), "Backend title should be visible");
}
```

### ðŸŸ¢ Green: Fix Existing Tests

Update existing subgraph test assertions:

1. **`simple_subgraph_renders_title_and_nodes()`**: Change assertion from floating title to embedded title (e.g., `output.contains("â”€ Process â”€")` instead of checking for "Process" as standalone line)

2. **`subgraph_edges_renders_both_groups()`**: Update assertions for "Input" and "Output" titles in embedded format

3. **`test_render_subgraph_title`** (unit test in subgraph.rs): Rewrite for embedded format

4. Any other tests that check subgraph output strings

### ðŸ”µ Refactor: Clean Up

Run `cargo test` and fix all remaining failures. Ensure non-subgraph fixtures are completely unaffected by the changes.

## Context
- Phases 1 and 2 change the visual output of all subgraph rendering
- Existing tests check for specific output patterns that will change
- LR layout title visibility (Issue 8) should now be fixed by embedded titles
- See [Q3: Overlap inventory](../../../research/0019-subgraph-padding-overlap/q3-overlap-inventory.md) Issues 1-10

## Acceptance Criteria
- [ ] All existing subgraph tests updated for new format
- [ ] New non-overlap integration test added
- [ ] New LR title visibility test added
- [ ] `cargo test` passes with zero failures
- [ ] Non-subgraph tests unaffected
