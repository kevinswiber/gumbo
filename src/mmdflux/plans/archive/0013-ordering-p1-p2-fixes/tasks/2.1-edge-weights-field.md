# Task 2.1: Add edge_weights Field and effective_edges_weighted() to LayoutGraph

## Objective

Add edge weight storage to `LayoutGraph` and provide a method to retrieve edges with their weights, enabling weighted barycenter computation.

## Location

Modify: `src/dagre/graph.rs` — `LayoutGraph` struct and impl

## Implementation

### Add field to struct

In the `LayoutGraph` struct definition (around line 120), add:

```rust
pub struct LayoutGraph {
    // ... existing fields ...

    /// Edge weights, indexed by position in `edges` vec. Default 1.0 for all edges.
    pub edge_weights: Vec<f64>,
}
```

### Initialize in `from_digraph()`

In the `from_digraph()` method, after the edges vec is populated, initialize weights:

```rust
// After edges are built (find the line that completes `edges` construction)
let edge_weights = vec![1.0; edges.len()];

// Include in the struct construction:
LayoutGraph {
    // ... existing fields ...
    edge_weights,
}
```

### Add `effective_edges_weighted()` method

Add a new method alongside the existing `effective_edges()`:

```rust
/// Returns edges as (from, to, weight) tuples, respecting reversed edges.
pub fn effective_edges_weighted(&self) -> Vec<(usize, usize, f64)> {
    self.edges
        .iter()
        .enumerate()
        .map(|(idx, &(from, to, _))| {
            let weight = self.edge_weights[idx];
            if self.reversed_edges.contains(&idx) {
                (to, from, weight)
            } else {
                (from, to, weight)
            }
        })
        .collect()
}
```

### Update normalize.rs edge creation

In `normalize.rs`, when new edges are added during long-edge splitting, ensure `edge_weights` is extended. Find where `graph.edges.push(...)` is called and add a corresponding `graph.edge_weights.push(1.0)` after each push. (The weight of dummy edge segments should be the same as the original edge's weight, but since all original weights are 1.0 currently, pushing 1.0 is correct.)

## Context

The existing `effective_edges()` returns `Vec<(usize, usize)>` and is used by multiple callers (order.rs, bk.rs, normalize.rs, rank.rs). We add a **new** method rather than changing the existing signature to avoid touching all callers. Only `order.rs` needs the weighted version.

Check `src/dagre/normalize.rs` for calls to `graph.edges.push(...)` — each needs a matching `graph.edge_weights.push(1.0)`.

## Acceptance Criteria

- [ ] `LayoutGraph` has `edge_weights: Vec<f64>` field
- [ ] `from_digraph()` initializes `edge_weights` to all 1.0
- [ ] `effective_edges_weighted()` returns `Vec<(usize, usize, f64)>` with correct reversal handling
- [ ] `normalize.rs` maintains `edge_weights` when adding new edges
- [ ] `cargo test` passes (no compilation errors from new field)
