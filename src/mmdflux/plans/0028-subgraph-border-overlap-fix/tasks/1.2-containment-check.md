# Task 1.2: Verify containment of member-node positions

## Objective
Write a test that runs the full layout pipeline on a subgraph fixture and verifies that dagre Rect bounds transformed via `to_ascii_rect()` contain the member nodes' draw positions.

## Location
Modify: `src/render/layout.rs` â€” add integration-level unit test

## TDD Phases

### ðŸ”´ Red: Write Failing Tests

```rust
#[test]
fn test_dagre_bounds_contain_member_nodes() {
    // Parse and layout a simple subgraph fixture
    // Then verify that transformed dagre bounds contain all member node draw positions
    let input = "graph TD\nsubgraph sg1[Group]\nA[Node1]\nB[Node2]\nend\nA --> B";
    // ... parse, build diagram, run layout ...
    // Get dagre bounds for sg1, transform via to_ascii_rect()
    // Get draw positions for A and B
    // Assert: sg1_draw_bounds contains A's draw rect
    // Assert: sg1_draw_bounds contains B's draw rect
}
```

**What the failing test asserts:** Transformed dagre bounds fully contain member-node draw positions.
**Expected failure reason:** The test infrastructure needs to expose dagre bounds and TransformContext from the layout pipeline.

### ðŸŸ¢ Green: Minimal Implementation

May require minor refactoring to expose dagre bounds from the layout pipeline:
- Ensure `compute_layout()` returns or exposes `subgraph_bounds` and the `TransformContext`
- Alternatively, add a test helper that runs the pipeline and returns both

### ðŸ”µ Refactor: Clean Up

- If the layout pipeline needed changes to expose data, ensure the public API remains clean
- Consider whether containment check should be a debug assertion in production code

## Context

This test catches systemic offsets between dagre bounds and node positions. If the formula is wrong by even 1 character, member nodes will fall outside the subgraph border. The test should use a real parse â†’ build â†’ layout pipeline, not mocked data.

## Acceptance Criteria
- [ ] Test runs the full pipeline on a subgraph fixture
- [ ] Verifies dagre bounds (transformed) contain all member node draw positions
- [ ] Catches any systematic offset between the two coordinate paths
