# Task 4.2: Verify Denormalization Extracts Label Positions

## Objective
Confirm that when dummy chains are collapsed back to waypoints, the label dummy's final (x, y) position is captured in the `label_positions` output of the layout result.

## Location
Tests in: `src/dagre/normalize.rs` or integration test module

## TDD Phases

### ðŸ”´ Red: Write Failing Tests

```rust
#[test]
fn test_denorm_extracts_label_position() {
    let mut g = DiGraph::new();
    let a = g.add_node("A", 5.0, 3.0);
    let b = g.add_node("B", 5.0, 3.0);
    g.add_edge(a, b);

    let mut edge_labels = HashMap::new();
    edge_labels.insert(0, EdgeLabelInfo::new(5.0, 1.0));

    let result = layout_with_labels(&g, &LayoutConfig::default(), &edge_labels);

    // label_positions should contain an entry for edge 0
    assert!(result.label_positions.contains_key(&0),
        "Label position should be computed for labeled edge");
    let pos = &result.label_positions[&0];
    // Position should be between A and B
    let a_y = result.positions[0].y;
    let b_y = result.positions[1].y;
    assert!(pos.y > a_y && pos.y < b_y,
        "Label position should be between source and target");
}
```

**What the failing test asserts:** `layout_with_labels` returns label positions for labeled edges.
**Expected failure reason:** May already work if the full pipeline is wired correctly from Tasks 2.1-2.2. If label positions are missing, the denormalization step needs fixing.

### ðŸŸ¢ Green: Minimal Implementation

Trace through `get_label_position()` in `normalize.rs` to ensure it extracts positions from label dummies. Fix if positions aren't being captured.

### ðŸ”µ Refactor: Clean Up

N/A if verification-only.

## Context
- `get_label_position()` in `normalize.rs` iterates dummy chains looking for `label_dummy_index`
- The label dummy's position after BK coordinate assignment becomes the label's center
- `LayoutResult` has a `label_positions: HashMap<usize, Point>` field

## Acceptance Criteria
- [ ] Test confirms label positions are in the layout result
- [ ] Label position is geometrically between source and target nodes
- [ ] Label position x-coordinate is reasonable (near the edge path)
