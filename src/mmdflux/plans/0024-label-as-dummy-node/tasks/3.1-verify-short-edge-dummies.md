# Task 3.1: Verify Label Dummies for Formerly-Short Edges

## Objective
Confirm that normalization creates label dummy nodes for edges that were originally 1-rank span but are now 2-rank span due to minlen=2.

## Location
Tests in: `src/dagre/normalize.rs` (or a test module)

## TDD Phases

### ðŸ”´ Red: Write Failing Tests

```rust
#[test]
fn test_short_edge_with_label_gets_dummy() {
    // Setup: A -> B with label, minlen=2
    // After ranking: A=rank 0, B=rank 2
    // After normalization: one dummy at rank 1 with EdgeLabel type
    let mut g = DiGraph::new();
    let a = g.add_node("A", 5.0, 3.0);
    let b = g.add_node("B", 5.0, 3.0);
    g.add_edge(a, b);

    let mut lg = LayoutGraph::from_digraph(&g, &LayoutConfig::default());
    let mut edge_labels = HashMap::new();
    edge_labels.insert(0, EdgeLabelInfo::new(5.0, 1.0));

    make_space_for_edge_labels(&mut lg, &edge_labels);
    rank::run(&mut lg);
    let chains = normalize::run(&mut lg, &edge_labels);

    // Should have one dummy chain for the A->B edge
    assert_eq!(chains.len(), 1);
    // The chain should have a label dummy
    let chain = &chains[0];
    assert!(chain.label_dummy_index.is_some());
    // The label dummy should have the label's dimensions (width=5.0, height=1.0)
}
```

**What the failing test asserts:** A formerly 1-rank edge with a label produces a dummy chain with a label dummy node that has the correct dimensions.
**Expected failure reason:** This may already pass if normalization correctly handles 2-rank edges with labels. If it fails, the normalization code needs adjustment to recognize the new edge as "long" and process it.

### ðŸŸ¢ Green: Minimal Implementation

If the test passes as-is, this task is a verification-only task (no code changes needed). If it fails, investigate what normalization expects and make the minimal fix.

### ðŸ”µ Refactor: Clean Up

N/A if verification-only.

## Context
- Normalization in `normalize::run()` processes edges where `to_rank > from_rank + 1`
- With minlen=2, a labeled A->B edge should get ranks 0 and 2, making it span 2 ranks
- The existing normalization code already has `DummyType::EdgeLabel` handling
- This task confirms the existing infrastructure works with the new minlen mechanism

## Acceptance Criteria
- [ ] Test written confirming label dummy creation for formerly-short edges
- [ ] Label dummy has correct dimensions (width and height from EdgeLabelInfo)
- [ ] Label dummy is at the midpoint rank
