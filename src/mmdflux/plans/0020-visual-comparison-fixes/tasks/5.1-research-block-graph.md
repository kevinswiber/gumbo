# Task 5.1: Research dagre.js Block Graph Implementation

## Objective
Study the dagre.js `coordinate.js` source to understand the block graph algorithm for horizontal compaction. Document findings to inform Task 5.3.

## Location
No code changes — produces a findings document in `findings/`.

## TDD Phases

This is a research task, not a code task. No TDD applies.

### Research Steps

1. Read dagre.js source: `lib/coordinate.js` (the `positionX` function)
2. Understand how the block graph is built from vertical alignment results
3. Document:
   - How blocks are formed from alignment chains
   - How the block graph adds edges for separation constraints
   - How compaction traverses the block graph
   - What separation constraints exist between blocks vs within blocks
4. Compare with the mmdflux implementation in `src/dagre/bk.rs`:
   - What's missing in the current `place_block()` (lines ~694-769)?
   - What separation constraints are being skipped?
5. Write findings to `findings/block-graph-algorithm.md`

### Output

A document in `findings/block-graph-algorithm.md` describing:
- The dagre.js block graph algorithm
- What's missing in mmdflux's implementation
- Whether Approach A (full block graph) or Approach B (post-BK nudge) is more appropriate

## Context
- See [q2-bk-stagger-mechanism.md](../../../research/0013-visual-comparison-fixes/q2-bk-stagger-mechanism.md)
- The BK algorithm is described in "Fast and Simple Horizontal Coordinate Assignment" (Brandes & Köpf, 2002)
- dagre.js extends the original BK algorithm with a block graph for compaction

## Acceptance Criteria
- [ ] dagre.js block graph algorithm documented
- [ ] Comparison with mmdflux implementation written
- [ ] Recommendation for implementation approach
