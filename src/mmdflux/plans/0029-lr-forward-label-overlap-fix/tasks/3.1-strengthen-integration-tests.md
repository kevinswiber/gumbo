# Task 3.1: Strengthen git_workflow Integration Test and Verify No Regressions

## Objective

Replace the existing weak `git_workflow_renders` test with stronger assertions that verify all forward edge labels are fully visible and no stray routing artifacts exist. Run the full test suite to verify no regressions across all fixtures.

## Location

Modify: `tests/integration.rs` â€” `git_workflow_renders` test (around line 314)

## TDD Phases

### ðŸ”´ Red: Write Failing Tests

If Phases 1-2 are already applied, these tests should pass immediately (they define the desired behavior that should already work). If running before Phases 1-2, the label assertions will fail.

```rust
#[test]
fn git_workflow_renders() {
    let output = render_fixture("git_workflow.mmd");

    // All node labels fully visible
    assert!(output.contains("Working Dir"), "Missing 'Working Dir':\n{output}");
    assert!(output.contains("Staging Area"), "Missing 'Staging Area':\n{output}");
    assert!(output.contains("Local Repo"), "Missing 'Local Repo':\n{output}");
    assert!(output.contains("Remote Repo"), "Missing 'Remote Repo':\n{output}");

    // All forward edge labels fully visible (not clipped by nodes)
    assert!(output.contains("git add"), "Missing 'git add' label:\n{output}");
    assert!(output.contains("git commit"), "Missing 'git commit' label:\n{output}");
    assert!(output.contains("git push"), "Missing 'git push' label:\n{output}");

    // Backward edge label
    assert!(output.contains("git pull"), "Missing 'git pull' label:\n{output}");
}
```

**What the failing test asserts:** All node labels and edge labels are fully visible as complete strings in the rendered output.
**Expected failure reason:** Before Phase 1, "git commit" appears as "mmit" (clipped), so `contains("git commit")` fails.

### ðŸŸ¢ Green: Minimal Implementation

The test itself defines the assertions. If Phases 1-2 are applied, no additional implementation code is needed â€” the tests should pass.

### ðŸ”µ Refactor: Clean Up

- Remove any now-obsolete weaker assertions from the existing test
- Run `cargo test` to verify all fixtures pass
- Run `cargo test --test integration` specifically to verify integration tests
- Visually inspect the rendered output of `git_workflow.mmd` to confirm it looks correct:
  ```bash
  cargo run -- tests/fixtures/git_workflow.mmd
  ```
- Check that these fixtures still render correctly:
  - `labeled_edges.mmd` (TD layout with labels)
  - `label_spacing.mmd` (TD layout with label spacing)
  - `left_right.mmd` (LR layout)
  - `right_left.mmd` (RL layout)
  - `bottom_top.mmd` (BT layout)

## Context

The current `git_workflow_renders` test only checks that all node labels appear, which passes even with corrupted edge labels. The strengthened test captures the fix from Phases 1-2 and prevents future regressions.

## Acceptance Criteria

- [ ] `git_workflow_renders` test asserts all 4 forward edge labels are fully visible
- [ ] No stray segment artifacts in output
- [ ] All existing integration tests still pass
- [ ] Full `cargo test` passes with no regressions
- [ ] Visual inspection of `git_workflow.mmd` output confirms correct rendering
