# Task 6.1: Flowchart Compliance Tests from Upstream

## Objective

Translate representative test cases from upstream Mermaid's flowchart spec files into Rust integration tests. Use `#[ignore]` for tests covering not-yet-implemented syntax to document the gap.

## Location

Create: `tests/compliance_flowchart.rs`
Source: `~/src/mermaid/packages/mermaid/src/diagrams/flowchart/parser/` (spec files)

## TDD Phases

### Red: Write Failing Tests

Translate test cases from each upstream spec file:

**From `flow-singlenode.spec.js`:**
- All node shape variants
- Bare node IDs
- Quoted text content

**From `flow-edges.spec.js`:**
- All edge syntax variants (solid, dotted, thick)
- Labeled edges with `|text|`

**From `flow-arrows.spec.js`:**
- Arrow head types (`>`, `x`, `o`)
- Bidirectional arrows
- Variable-length edges

**From `flow-lines.spec.js`:**
- Multi-line statements
- Semicolon separators

**From `flow-comments.spec.js`:**
- `%%` comments
- Comments between statements

**From `flow-direction.spec.js`:**
- All direction keywords (TD, TB, BT, LR, RL)

**From `flow-vertice-chaining.spec.js`:**
- Chain syntax (`A --> B --> C`)
- Ampersand groups (`A & B --> C`)

**From `subgraph.spec.js`:**
- Subgraph with brackets
- Nested subgraphs
- Subgraph direction

Each test should verify that `parse_flowchart(input)` succeeds and produces the expected structural result (correct number of nodes, edges, correct shapes/labels).

### Green: Minimal Implementation

No production code changes â€” this task only creates tests. Tests for already-supported syntax should pass immediately. Tests for unsupported syntax are marked `#[ignore]`.

### Refactor: Clean Up

- Organize tests by upstream spec file using `mod` blocks
- Add comments linking each test back to the upstream spec file and line number
- Tally: X tests passing, Y tests ignored (documents compliance gap)

## Context

The upstream spec files are the ground truth for Mermaid parsing behavior. See [research synthesis](../../../research/0026-mermaid-grammar-reference/synthesis.md) recommendation #3.

## Acceptance Criteria

- [ ] Tests translated from all major upstream spec files
- [ ] Passing tests for currently-supported syntax
- [ ] `#[ignore]` tests for unsupported syntax with comments explaining what's needed
- [ ] Test count tallied in a comment at the top of the file
