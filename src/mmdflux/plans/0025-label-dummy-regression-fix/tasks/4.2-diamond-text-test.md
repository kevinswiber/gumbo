# Task 4.2: Verify diamond text integrity

## Objective

Verify that diamond node text is not corrupted by edge arrows in rendered output.

## Location

Modify: `tests/integration.rs`

## TDD Phases

### ðŸ”´ Red: Write Failing Tests

```rust
#[test]
fn diamond_text_not_corrupted_by_arrows() {
    // labeled_edges.mmd contains a diamond node "Valid?" with a backward edge
    let input = std::fs::read_to_string("tests/fixtures/labeled_edges.mmd").unwrap();
    let flowchart = mmdflux::parser::parse_flowchart(&input).unwrap();
    let diagram = mmdflux::graph::build_diagram(&flowchart);
    let output = mmdflux::render::render(&diagram, &Default::default());

    // The diamond should contain "Valid?" text, not corrupted by arrow characters
    assert!(
        output.contains("Valid?"),
        "Diamond text 'Valid?' should be intact in output:\n{output}"
    );
}
```

**What the failing test asserts:** Diamond node text is intact in rendered output.
**Expected failure reason:** Before task 4.1, arrow overwriting corrupts diamond text.

### ðŸŸ¢ Green: Minimal Implementation

Should pass after task 4.1 is complete.

### ðŸ”µ Refactor: Clean Up

- Check if `labeled_edges.mmd` actually contains a diamond node with "Valid?" â€” adjust fixture name/text if needed

## Context

- The research identified diamond text corruption as a visible symptom of the arrow z-order bug
- This may only manifest when backward edge paths cross diamond nodes

## Acceptance Criteria

- [ ] Test written for diamond text integrity
- [ ] Diamond text is intact in rendered output
- [ ] `cargo test` passes
