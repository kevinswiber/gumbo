# Task 1.3: Integration test â€” labeled_edges vertical height is reasonable

## Objective

Verify that after global minlen doubling + ranksep halving, the `labeled_edges.mmd` fixture renders at a reasonable height (not the 51+ lines of the regression).

## Location

Modify: `tests/integration.rs`

## TDD Phases

### ðŸ”´ Red: Write Failing Tests

```rust
#[test]
fn labeled_edges_reasonable_height() {
    let input = std::fs::read_to_string("tests/fixtures/labeled_edges.mmd").unwrap();
    let flowchart = mmdflux::parser::parse_flowchart(&input).unwrap();
    let diagram = mmdflux::graph::build_diagram(&flowchart);
    let output = mmdflux::render::render(&diagram, &Default::default());
    let line_count = output.lines().count();

    // Main branch renders ~29 lines. Regression was 51+ lines.
    // With the fix, expect similar to main branch (allow some tolerance for label dummies).
    assert!(
        line_count < 40,
        "labeled_edges.mmd should render in under 40 lines, got {line_count}"
    );

    // All 5 labels should be present
    for label in &["initialize", "configure", "yes", "no", "retry"] {
        assert!(
            output.contains(label),
            "Output should contain label '{label}'"
        );
    }
}
```

**What the failing test asserts:** Rendered output is compact and contains all labels.
**Expected failure reason:** Before tasks 1.1 and 1.2, the output is either too tall (regression) or labels are missing.

### ðŸŸ¢ Green: Minimal Implementation

Should pass after tasks 1.1 and 1.2 are complete. No additional code needed.

### ðŸ”µ Refactor: Clean Up

Adjust the height threshold if the actual output differs from expected range.

## Context

- `labeled_edges.mmd` has 5 labeled edges including a backward edge ("retry")
- Main branch renders ~29 lines
- The regression renders 51+ lines due to asymmetric rank inflation

## Acceptance Criteria

- [ ] Test written and run (may initially fail before 1.1/1.2)
- [ ] After Phase 1 changes, output is under 40 lines
- [ ] All 5 labels ("initialize", "configure", "yes", "no", "retry") present in output
